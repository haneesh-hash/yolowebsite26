<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YOLO Admin ‚Äî Content Management</title>
    <link rel="icon" type="image/svg+xml" href="../logo.svg?v=1771706725">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Outfit:wght@600;700;800&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-card: #1a1a26;
            --bg-input: #22222e;
            --border: rgba(255, 255, 255, 0.08);
            --border-focus: #74ACDF;
            --text-primary: #f0f0f5;
            --text-secondary: rgba(240, 240, 245, 0.6);
            --text-muted: rgba(240, 240, 245, 0.35);
            --accent: #74ACDF;
            --accent-hover: #5a9ad4;
            --danger: #ef4444;
            --danger-hover: #dc2626;
            --success: #22c55e;
            --warning: #f59e0b;
            --radius: 10px;
            --glass: rgba(255, 255, 255, 0.04);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
        }

        /* ‚îÄ‚îÄ‚îÄ Sidebar ‚îÄ‚îÄ‚îÄ */
        .sidebar {
            width: 260px;
            background: var(--bg-secondary);
            border-right: 1px solid var(--border);
            padding: 2rem 0;
            display: flex;
            flex-direction: column;
            position: fixed;
            top: 0;
            left: 0;
            bottom: 0;
            z-index: 100;
        }

        .sidebar-brand {
            padding: 0 1.5rem 2rem;
            border-bottom: 1px solid var(--border);
            margin-bottom: 1rem;
        }

        .sidebar-brand h1 {
            font-family: 'Outfit', sans-serif;
            font-size: 1.3rem;
            font-weight: 700;
            letter-spacing: -0.02em;
        }

        .sidebar-brand span {
            font-size: 0.72rem;
            color: var(--text-muted);
            letter-spacing: 0.12em;
            text-transform: uppercase;
            display: block;
            margin-top: 0.25rem;
        }

        .sidebar-nav {
            flex: 1;
            padding: 0.5rem 0.75rem;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            color: var(--text-secondary);
            font-size: 0.88rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            margin-bottom: 0.25rem;
        }

        .nav-item:hover {
            background: var(--glass);
            color: var(--text-primary);
        }

        .nav-item.active {
            background: rgba(116, 172, 223, 0.12);
            color: var(--accent);
        }

        .nav-item svg {
            width: 20px;
            height: 20px;
            flex-shrink: 0;
        }

        .sidebar-footer {
            padding: 1rem 1.5rem;
            border-top: 1px solid var(--border);
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .sidebar-footer a {
            color: var(--accent);
            text-decoration: none;
        }

        /* ‚îÄ‚îÄ‚îÄ Main ‚îÄ‚îÄ‚îÄ */
        .main {
            margin-left: 260px;
            flex: 1;
            min-height: 100vh;
            padding: 2rem 2.5rem;
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .page-title {
            font-family: 'Outfit', sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
        }

        .page-subtitle {
            color: var(--text-secondary);
            font-size: 0.85rem;
            margin-top: 0.25rem;
        }

        /* ‚îÄ‚îÄ‚îÄ Buttons ‚îÄ‚îÄ‚îÄ */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.65rem 1.25rem;
            border-radius: 8px;
            font-family: 'Inter', sans-serif;
            font-size: 0.82rem;
            font-weight: 600;
            letter-spacing: 0.02em;
            cursor: pointer;
            border: none;
            transition: all 0.2s;
        }

        .btn-primary {
            background: var(--accent);
            color: #fff;
        }

        .btn-primary:hover {
            background: var(--accent-hover);
            transform: translateY(-1px);
        }

        .btn-danger {
            background: transparent;
            color: var(--danger);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .btn-danger:hover {
            background: var(--danger);
            color: #fff;
        }

        .btn-ghost {
            background: transparent;
            color: var(--text-secondary);
            border: 1px solid var(--border);
        }

        .btn-ghost:hover {
            background: var(--glass);
            color: var(--text-primary);
        }

        .btn-sm {
            padding: 0.4rem 0.8rem;
            font-size: 0.75rem;
        }

        /* ‚îÄ‚îÄ‚îÄ Table ‚îÄ‚îÄ‚îÄ */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: var(--bg-card);
            border-radius: var(--radius);
            overflow: hidden;
            border: 1px solid var(--border);
        }

        .data-table thead {
            background: var(--bg-input);
        }

        .data-table th {
            padding: 0.85rem 1.2rem;
            text-align: left;
            font-size: 0.72rem;
            font-weight: 600;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            color: var(--text-muted);
        }

        .data-table td {
            padding: 0.85rem 1.2rem;
            border-top: 1px solid var(--border);
            font-size: 0.85rem;
            color: var(--text-secondary);
            vertical-align: middle;
        }

        .data-table tr:hover td {
            background: rgba(255, 255, 255, 0.02);
        }

        .table-img {
            width: 56px;
            height: 40px;
            object-fit: cover;
            border-radius: 6px;
            border: 1px solid var(--border);
        }

        .table-actions {
            display: flex;
            gap: 0.4rem;
        }

        .badge {
            display: inline-block;
            padding: 0.2rem 0.6rem;
            border-radius: 100px;
            font-size: 0.68rem;
            font-weight: 600;
            letter-spacing: 0.04em;
        }

        .badge-accent {
            background: rgba(116, 172, 223, 0.15);
            color: var(--accent);
        }

        .badge-success {
            background: rgba(34, 197, 94, 0.15);
            color: var(--success);
        }

        /* ‚îÄ‚îÄ‚îÄ Forms (Modal) ‚îÄ‚îÄ‚îÄ */
        .modal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px);
            z-index: 1000;
            justify-content: center;
            align-items: flex-start;
            padding: 4rem 1rem;
            overflow-y: auto;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 14px;
            width: 100%;
            max-width: 680px;
            padding: 2rem;
            position: relative;
            animation: modalIn 0.2s ease-out;
        }

        @keyframes modalIn {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.98);
            }

            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border);
        }

        .modal-header h2 {
            font-family: 'Outfit', sans-serif;
            font-size: 1.3rem;
            font-weight: 700;
        }

        .modal-close {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: 1px solid var(--border);
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .modal-close:hover {
            background: var(--danger);
            color: #fff;
            border-color: var(--danger);
        }

        .form-group {
            margin-bottom: 1.25rem;
        }

        .form-group label {
            display: block;
            font-size: 0.75rem;
            font-weight: 600;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            color: var(--text-secondary);
            margin-bottom: 0.4rem;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 0.7rem 1rem;
            background: var(--bg-input);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            font-family: 'Inter', sans-serif;
            font-size: 0.88rem;
            transition: border-color 0.2s;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--border-focus);
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .form-row-3 {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 1rem;
        }

        .form-check {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .form-check input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--accent);
        }

        .file-upload {
            padding: 1.5rem;
            border: 2px dashed var(--border);
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .file-upload:hover {
            border-color: var(--accent);
            background: rgba(116, 172, 223, 0.05);
        }

        .file-upload input {
            display: none;
        }

        .file-upload p {
            color: var(--text-muted);
            font-size: 0.82rem;
            margin-top: 0.3rem;
        }

        .file-upload .upload-icon {
            font-size: 1.5rem;
            margin-bottom: 0.3rem;
        }

        .file-upload .file-name {
            color: var(--accent);
            font-weight: 600;
            margin-top: 0.5rem;
            font-size: 0.82rem;
        }

        /* ‚îÄ‚îÄ‚îÄ Image Grid ‚îÄ‚îÄ‚îÄ */
        .image-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .image-card {
            position: relative;
            border-radius: var(--radius);
            overflow: hidden;
            border: 1px solid var(--border);
            background: var(--bg-card);
            transition: all 0.2s;
        }

        .image-card:hover {
            border-color: var(--accent);
        }

        .image-card img {
            width: 100%;
            height: 120px;
            object-fit: cover;
            display: block;
        }

        .image-card-info {
            padding: 0.5rem 0.6rem;
            font-size: 0.7rem;
            color: var(--text-muted);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .image-card-delete {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border: none;
            background: rgba(239, 68, 68, 0.15);
            color: var(--danger);
            cursor: pointer;
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .image-card-delete:hover {
            background: var(--danger);
            color: #fff;
        }

        /* ‚îÄ‚îÄ‚îÄ Section Panels ‚îÄ‚îÄ‚îÄ */
        .panel {
            display: none;
        }

        .panel.active {
            display: block;
        }

        /* ‚îÄ‚îÄ‚îÄ Property Tabs ‚îÄ‚îÄ‚îÄ */
        .prop-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .prop-tab {
            padding: 0.5rem 1.2rem;
            border-radius: 100px;
            border: 1px solid var(--border);
            background: transparent;
            color: var(--text-secondary);
            font-family: 'Inter', sans-serif;
            font-size: 0.82rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .prop-tab:hover {
            background: var(--glass);
            color: var(--text-primary);
        }

        .prop-tab.active {
            background: rgba(116, 172, 223, 0.12);
            color: var(--accent);
            border-color: rgba(116, 172, 223, 0.3);
        }

        /* ‚îÄ‚îÄ‚îÄ Toast ‚îÄ‚îÄ‚îÄ */
        .toast-container {
            position: fixed;
            top: 1.5rem;
            right: 1.5rem;
            z-index: 2000;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .toast {
            padding: 0.8rem 1.2rem;
            border-radius: 10px;
            font-size: 0.85rem;
            font-weight: 500;
            animation: toastIn 0.3s ease-out, toastOut 0.3s ease-in 2.7s forwards;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .toast-success {
            background: rgba(34, 197, 94, 0.15);
            color: var(--success);
            border: 1px solid rgba(34, 197, 94, 0.2);
        }

        .toast-error {
            background: rgba(239, 68, 68, 0.15);
            color: var(--danger);
            border: 1px solid rgba(239, 68, 68, 0.2);
        }

        @keyframes toastIn {
            from {
                opacity: 0;
                transform: translateX(40px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes toastOut {
            from {
                opacity: 1;
            }

            to {
                opacity: 0;
                transform: translateY(-10px);
            }
        }

        /* ‚îÄ‚îÄ‚îÄ Stats Row ‚îÄ‚îÄ‚îÄ */
        .stats-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 1.25rem;
        }

        .stat-card .stat-label {
            font-size: 0.72rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-muted);
        }

        .stat-card .stat-value {
            font-family: 'Outfit', sans-serif;
            font-size: 2rem;
            font-weight: 700;
            margin-top: 0.25rem;
            color: var(--accent);
        }

        /* ‚îÄ‚îÄ‚îÄ Loading ‚îÄ‚îÄ‚îÄ */
        .loading {
            text-align: center;
            padding: 3rem;
            color: var(--text-muted);
        }

        /* ‚îÄ‚îÄ‚îÄ Responsive ‚îÄ‚îÄ‚îÄ */
        @media (max-width: 900px) {
            .sidebar {
                width: 60px;
                padding: 1rem 0;
            }

            .sidebar-brand h1,
            .sidebar-brand span,
            .nav-item span,
            .sidebar-footer {
                display: none;
            }

            .nav-item {
                justify-content: center;
                padding: 0.75rem;
            }

            .main {
                margin-left: 60px;
                padding: 1.5rem;
            }

            .form-row,
            .form-row-3 {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-brand">
            <h1>YOLO Admin</h1>
            <span>Content Manager</span>
        </div>
        <nav class="sidebar-nav">
            <a class="nav-item active" data-panel="blogs" onclick="switchPanel('blogs')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20" />
                    <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z" />
                </svg>
                <span>Blogs</span>
            </a>
            <a class="nav-item" data-panel="experiences" onclick="switchPanel('experiences')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <polygon
                        points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2" />
                </svg>
                <span>Experiences</span>
            </a>
            <a class="nav-item" data-panel="images" onclick="switchPanel('images')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
                    <circle cx="8.5" cy="8.5" r="1.5" />
                    <polyline points="21 15 16 10 5 21" />
                </svg>
                <span>Property Images</span>
            </a>
        </nav>
        <div class="sidebar-footer">
            <a href="/">‚Üê Back to Site</a>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main">
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê BLOGS PANEL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div id="panel-blogs" class="panel active">
            <div class="page-header">
                <div>
                    <h2 class="page-title">Blog Posts</h2>
                    <p class="page-subtitle">Manage stories from the Himalayas</p>
                </div>
                <button class="btn btn-primary" onclick="openBlogModal()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19" />
                        <line x1="5" y1="12" x2="19" y2="12" />
                    </svg>
                    New Blog Post
                </button>
            </div>
            <div class="stats-row" id="blogStats"></div>
            <table class="data-table" id="blogTable">
                <thead>
                    <tr>
                        <th>Image</th>
                        <th>Title</th>
                        <th>Category</th>
                        <th>Tag</th>
                        <th>Date</th>
                        <th>Featured</th>
                        <th style="width:120px">Actions</th>
                    </tr>
                </thead>
                <tbody id="blogTableBody">
                    <tr>
                        <td colspan="7" class="loading">Loading blogs...</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê EXPERIENCES PANEL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div id="panel-experiences" class="panel">
            <div class="page-header">
                <div>
                    <h2 class="page-title">Experiences</h2>
                    <p class="page-subtitle">Manage curated mountain experiences</p>
                </div>
                <button class="btn btn-primary" onclick="openExpModal()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19" />
                        <line x1="5" y1="12" x2="19" y2="12" />
                    </svg>
                    New Experience
                </button>
            </div>
            <div class="stats-row" id="expStats"></div>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Image</th>
                        <th>Title</th>
                        <th>Category</th>
                        <th>Badge</th>
                        <th>Link</th>
                        <th>Featured</th>
                        <th style="width:120px">Actions</th>
                    </tr>
                </thead>
                <tbody id="expTableBody">
                    <tr>
                        <td colspan="7" class="loading">Loading experiences...</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê IMAGES PANEL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div id="panel-images" class="panel">
            <div class="page-header" style="margin-bottom: 1rem;">
                <div>
                    <h2 class="page-title">Property Images</h2>
                    <p class="page-subtitle">Upload and manage images for each property</p>
                </div>
                <button class="btn btn-danger" id="deletePropertyBtn" onclick="deleteCurrentProperty()"
                    style="display: none;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="3 6 5 6 21 6"></polyline>
                        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                    </svg>
                    Delete Property
                </button>
            </div>
            <div class="prop-tabs" id="propTabs">
                <div class="loading" style="padding: 0.5rem;">Loading properties...</div>
            </div>
            <div style="margin-bottom: 1.5rem;">
                <div class="file-upload" id="propFileUpload">
                    <input type="file" id="propFileInput" accept="image/*" onchange="uploadPropertyImage()">
                    <div class="upload-icon">üì∑</div>
                    <p>Click to upload or drag & drop</p>
                    <p style="font-size:0.72rem;">JPEG, PNG, WebP, GIF, SVG ‚Äî Max 10MB</p>
                    <div class="file-name" id="propFileName"></div>
                </div>
            </div>
            <div class="image-grid" id="propImageGrid">
                <div class="loading">Loading images...</div>
            </div>
        </div>
    </main>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê BLOG MODAL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="modal-overlay" id="blogModal">
        <div class="modal">
            <div class="modal-header">
                <h2 id="blogModalTitle">New Blog Post</h2>
                <button class="modal-close" onclick="closeBlogModal()">‚úï</button>
            </div>
            <form id="blogForm" onsubmit="saveBlog(event)">
                <input type="hidden" id="blogEditId" value="">
                <div class="form-group">
                    <label>Title</label>
                    <input type="text" id="blogTitle" required placeholder="5 Reasons Why...">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Category</label>
                        <input type="text" id="blogCategory" required placeholder="Travel Tips">
                    </div>
                    <div class="form-group">
                        <label>Tag</label>
                        <input type="text" id="blogTag" required placeholder="Hostel Life">
                    </div>
                </div>
                <div class="form-row-3">
                    <div class="form-group">
                        <label>Date</label>
                        <input type="text" id="blogDate" placeholder="June 15, 2023">
                    </div>
                    <div class="form-group">
                        <label>Read Time</label>
                        <input type="text" id="blogReadTime" placeholder="5 min read">
                    </div>
                    <div class="form-group">
                        <div class="form-check" style="margin-top: 1.5rem;">
                            <input type="checkbox" id="blogFeatured">
                            <label style="margin: 0; text-transform: none; font-size: 0.85rem;">Featured</label>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>Excerpt</label>
                    <textarea id="blogExcerpt" rows="2" required
                        placeholder="Short summary shown on card..."></textarea>
                </div>
                <div class="form-group">
                    <label>Cover Image</label>
                    <div class="file-upload" onclick="document.getElementById('blogImageFile').click()">
                        <input type="file" id="blogImageFile" accept="image/*">
                        <div class="upload-icon">üñºÔ∏è</div>
                        <p>Click to choose an image</p>
                        <div class="file-name" id="blogImageName"></div>
                    </div>
                </div>
                <div class="form-group">
                    <label>Image Alt Text</label>
                    <input type="text" id="blogImageAlt" placeholder="Description of the image">
                </div>
                <div class="form-group">
                    <label>External URL</label>
                    <input type="url" id="blogUrl" placeholder="https://...">
                </div>
                <div class="form-group">
                    <label>Body (one paragraph per line)</label>
                    <textarea id="blogBody" rows="6"
                        placeholder="Paragraph 1&#10;&#10;Paragraph 2&#10;&#10;Paragraph 3"></textarea>
                </div>
                <div style="display: flex; gap: 0.75rem; justify-content: flex-end; margin-top: 1.5rem;">
                    <button type="button" class="btn btn-ghost" onclick="closeBlogModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Blog Post</button>
                </div>
            </form>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê EXPERIENCE MODAL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="modal-overlay" id="expModal">
        <div class="modal">
            <div class="modal-header">
                <h2 id="expModalTitle">New Experience</h2>
                <button class="modal-close" onclick="closeExpModal()">‚úï</button>
            </div>
            <form id="expForm" onsubmit="saveExperience(event)">
                <input type="hidden" id="expEditId" value="">
                <div class="form-group">
                    <label>Title</label>
                    <input type="text" id="expTitle" required placeholder="Parvati Valley Escape">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Category / Filter Tag</label>
                        <select id="expCategory" required>
                            <option value="">Select...</option>
                            <option value="escape">Escape</option>
                            <option value="trek">Trek</option>
                            <option value="wellness">Wellness</option>
                            <option value="culture">Culture</option>
                            <option value="nightsky">Night Sky</option>
                            <option value="nature">Nature</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Badge Text</label>
                        <input type="text" id="expBadge" required placeholder="‚ú¶ Featured">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Meta Text</label>
                        <input type="text" id="expMeta" placeholder="Valley Escape ¬∑ Multi-day">
                    </div>
                    <div class="form-group">
                        <label>Link URL</label>
                        <input type="text" id="expLink" placeholder="experience-parvati.html">
                    </div>
                </div>
                <div class="form-group">
                    <label>Excerpt</label>
                    <textarea id="expExcerpt" rows="3" required
                        placeholder="Short description shown on card..."></textarea>
                </div>
                <div class="form-group">
                    <label>Image</label>
                    <div class="file-upload" onclick="document.getElementById('expImageFile').click()">
                        <input type="file" id="expImageFile" accept="image/*">
                        <div class="upload-icon">üñºÔ∏è</div>
                        <p>Click to choose an image</p>
                        <div class="file-name" id="expImageName"></div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <div class="form-check" style="margin-top: 0.5rem;">
                            <input type="checkbox" id="expFeatured">
                            <label style="margin: 0; text-transform: none; font-size: 0.85rem;">Featured</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="form-check" style="margin-top: 0.5rem;">
                            <input type="checkbox" id="expWide">
                            <label style="margin: 0; text-transform: none; font-size: 0.85rem;">Wide card (spans 2
                                columns)</label>
                        </div>
                    </div>
                </div>
                <div style="display: flex; gap: 0.75rem; justify-content: flex-end; margin-top: 1.5rem;">
                    <button type="button" class="btn btn-ghost" onclick="closeExpModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Experience</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="../config.js"></script>
    <script>
        // ‚îÄ‚îÄ‚îÄ State ‚îÄ‚îÄ‚îÄ
        let blogs = [];
        let experiences = [];
        let propertyImages = {};
        let currentProperty = 'general';

        // ‚îÄ‚îÄ‚îÄ Toast ‚îÄ‚îÄ‚îÄ
        function showToast(message, type = 'success') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.innerHTML = `${type === 'success' ? '‚úì' : '‚úï'} ${message}`;
            container.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }

        // ‚îÄ‚îÄ‚îÄ Panel Switching ‚îÄ‚îÄ‚îÄ
        function switchPanel(panel) {
            document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(`panel-${panel}`).classList.add('active');
            document.querySelector(`[data-panel="${panel}"]`).classList.add('active');
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        //  BLOGS
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        async function loadBlogs() {
            try {
                const res = await fetch(config.apiBaseUrl + '/api/blogs');
                blogs = await res.json();
                renderBlogTable();
                renderBlogStats();
            } catch (e) {
                showToast('Failed to load blogs', 'error');
            }
        }

        function renderBlogStats() {
            document.getElementById('blogStats').innerHTML = `
                <div class="stat-card">
                    <div class="stat-label">Total Posts</div>
                    <div class="stat-value">${blogs.length}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Featured</div>
                    <div class="stat-value">${blogs.filter(b => b.featured).length}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Categories</div>
                    <div class="stat-value">${new Set(blogs.map(b => b.category)).size}</div>
                </div>
            `;
        }

        function renderBlogTable() {
            const tbody = document.getElementById('blogTableBody');
            if (blogs.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" class="loading">No blog posts yet. Click "New Blog Post" to add one.</td></tr>';
                return;
            }
            tbody.innerHTML = blogs.map(b => `
                <tr>
                    <td><img class="table-img" src="/${b.image}" alt="${b.imageAlt || ''}" onerror="this.style.display='none'"></td>
                    <td style="color:var(--text-primary);font-weight:500;max-width:250px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">${escHtml(b.title)}</td>
                    <td><span class="badge badge-accent">${escHtml(b.category)}</span></td>
                    <td>${escHtml(b.tag)}</td>
                    <td>${escHtml(b.date)}</td>
                    <td>${b.featured ? '<span class="badge badge-success">Yes</span>' : '‚Äî'}</td>
                    <td>
                        <div class="table-actions">
                            <button class="btn btn-ghost btn-sm" onclick="editBlog(${b.id})">Edit</button>
                            <button class="btn btn-danger btn-sm" onclick="deleteBlog(${b.id})">Delete</button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function openBlogModal(blog = null) {
            document.getElementById('blogEditId').value = blog ? blog.id : '';
            document.getElementById('blogModalTitle').textContent = blog ? 'Edit Blog Post' : 'New Blog Post';
            document.getElementById('blogTitle').value = blog ? blog.title : '';
            document.getElementById('blogCategory').value = blog ? blog.category : '';
            document.getElementById('blogTag').value = blog ? blog.tag : '';
            document.getElementById('blogDate').value = blog ? blog.date : '';
            document.getElementById('blogReadTime').value = blog ? blog.readTime : '';
            document.getElementById('blogFeatured').checked = blog ? blog.featured : false;
            document.getElementById('blogExcerpt').value = blog ? blog.excerpt : '';
            document.getElementById('blogImageAlt').value = blog ? blog.imageAlt : '';
            document.getElementById('blogUrl').value = blog ? blog.url : '';
            document.getElementById('blogBody').value = blog ? (blog.body || []).join('\n\n') : '';
            document.getElementById('blogImageName').textContent = blog && blog.image ? blog.image : '';
            document.getElementById('blogImageFile').value = '';
            document.getElementById('blogModal').classList.add('active');
        }

        function closeBlogModal() {
            document.getElementById('blogModal').classList.remove('active');
        }

        function editBlog(id) {
            const blog = blogs.find(b => b.id === id);
            if (blog) openBlogModal(blog);
        }

        async function saveBlog(e) {
            e.preventDefault();
            const editId = document.getElementById('blogEditId').value;
            const formData = new FormData();

            formData.append('title', document.getElementById('blogTitle').value);
            formData.append('category', document.getElementById('blogCategory').value);
            formData.append('tag', document.getElementById('blogTag').value);
            formData.append('date', document.getElementById('blogDate').value);
            formData.append('readTime', document.getElementById('blogReadTime').value);
            formData.append('featured', document.getElementById('blogFeatured').checked);
            formData.append('excerpt', document.getElementById('blogExcerpt').value);
            formData.append('imageAlt', document.getElementById('blogImageAlt').value);
            formData.append('url', document.getElementById('blogUrl').value);

            const bodyText = document.getElementById('blogBody').value.trim();
            if (bodyText) {
                formData.append('body', JSON.stringify(bodyText.split(/\n\n+/).filter(p => p.trim())));
            }

            const imageFile = document.getElementById('blogImageFile').files[0];
            if (imageFile) formData.append('image', imageFile);

            try {
                const url = config.apiBaseUrl + (editId ? `/api/blogs/${editId}` : '/api/blogs');
                const method = editId ? 'PUT' : 'POST';
                const res = await fetch(url, { method, body: formData });
                if (!res.ok) throw new Error(await res.text());
                showToast(editId ? 'Blog updated!' : 'Blog created!');
                closeBlogModal();
                loadBlogs();
            } catch (e) {
                showToast('Error saving blog: ' + e.message, 'error');
            }
        }

        async function deleteBlog(id) {
            if (!confirm('Delete this blog post?')) return;
            try {
                const res = await fetch(config.apiBaseUrl + `/api/blogs/${id}`, { method: 'DELETE' });
                if (!res.ok) throw new Error('Delete failed');
                showToast('Blog deleted');
                loadBlogs();
            } catch (e) {
                showToast('Error deleting blog', 'error');
            }
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        //  EXPERIENCES
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        async function loadExperiences() {
            try {
                const res = await fetch(config.apiBaseUrl + '/api/experiences');
                experiences = await res.json();
                renderExpTable();
                renderExpStats();
            } catch (e) {
                showToast('Failed to load experiences', 'error');
            }
        }

        function renderExpStats() {
            document.getElementById('expStats').innerHTML = `
                <div class="stat-card">
                    <div class="stat-label">Total Experiences</div>
                    <div class="stat-value">${experiences.length}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Featured</div>
                    <div class="stat-value">${experiences.filter(e => e.featured).length}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Categories</div>
                    <div class="stat-value">${new Set(experiences.map(e => e.category)).size}</div>
                </div>
            `;
        }

        function renderExpTable() {
            const tbody = document.getElementById('expTableBody');
            if (experiences.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" class="loading">No experiences yet.</td></tr>';
                return;
            }
            tbody.innerHTML = experiences.map(e => `
                <tr>
                    <td><img class="table-img" src="/${e.image}" alt="${e.title}" onerror="this.style.display='none'"></td>
                    <td style="color:var(--text-primary);font-weight:500;">${escHtml(e.title)}</td>
                    <td><span class="badge badge-accent">${escHtml(e.category)}</span></td>
                    <td>${escHtml(e.badge)}</td>
                    <td style="font-size:0.78rem;">${escHtml(e.link)}</td>
                    <td>${e.featured ? '<span class="badge badge-success">Yes</span>' : '‚Äî'}</td>
                    <td>
                        <div class="table-actions">
                            <button class="btn btn-ghost btn-sm" onclick="editExp(${e.id})">Edit</button>
                            <button class="btn btn-danger btn-sm" onclick="deleteExp(${e.id})">Delete</button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function openExpModal(exp = null) {
            document.getElementById('expEditId').value = exp ? exp.id : '';
            document.getElementById('expModalTitle').textContent = exp ? 'Edit Experience' : 'New Experience';
            document.getElementById('expTitle').value = exp ? exp.title : '';
            document.getElementById('expCategory').value = exp ? exp.category : '';
            document.getElementById('expBadge').value = exp ? exp.badge : '';
            document.getElementById('expMeta').value = exp ? exp.meta : '';
            document.getElementById('expLink').value = exp ? exp.link : '';
            document.getElementById('expExcerpt').value = exp ? exp.excerpt : '';
            document.getElementById('expFeatured').checked = exp ? exp.featured : false;
            document.getElementById('expWide').checked = exp ? exp.wide : false;
            document.getElementById('expImageName').textContent = exp && exp.image ? exp.image : '';
            document.getElementById('expImageFile').value = '';
            document.getElementById('expModal').classList.add('active');
        }

        function closeExpModal() {
            document.getElementById('expModal').classList.remove('active');
        }

        function editExp(id) {
            const exp = experiences.find(e => e.id === id);
            if (exp) openExpModal(exp);
        }

        async function saveExperience(e) {
            e.preventDefault();
            const editId = document.getElementById('expEditId').value;
            const formData = new FormData();

            formData.append('title', document.getElementById('expTitle').value);
            formData.append('category', document.getElementById('expCategory').value);
            formData.append('filterTag', document.getElementById('expCategory').value);
            formData.append('badge', document.getElementById('expBadge').value);
            formData.append('meta', document.getElementById('expMeta').value);
            formData.append('link', document.getElementById('expLink').value);
            formData.append('excerpt', document.getElementById('expExcerpt').value);
            formData.append('featured', document.getElementById('expFeatured').checked);
            formData.append('wide', document.getElementById('expWide').checked);

            const imageFile = document.getElementById('expImageFile').files[0];
            if (imageFile) formData.append('image', imageFile);

            try {
                const url = config.apiBaseUrl + (editId ? `/api/experiences/${editId}` : '/api/experiences');
                const method = editId ? 'PUT' : 'POST';
                const res = await fetch(url, { method, body: formData });
                if (!res.ok) throw new Error(await res.text());
                showToast(editId ? 'Experience updated!' : 'Experience created!');
                closeExpModal();
                loadExperiences();
            } catch (e) {
                showToast('Error saving experience: ' + e.message, 'error');
            }
        }

        async function deleteExp(id) {
            if (!confirm('Delete this experience?')) return;
            try {
                const res = await fetch(config.apiBaseUrl + `/api/experiences/${id}`, { method: 'DELETE' });
                if (!res.ok) throw new Error('Delete failed');
                showToast('Experience deleted');
                loadExperiences();
            } catch (e) {
                showToast('Error deleting experience', 'error');
            }
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        //  PROPERTY IMAGES
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        function switchProperty(prop) {
            currentProperty = prop;
            document.querySelectorAll('.prop-tab').forEach(t => t.classList.remove('active'));
            document.querySelector(`[data-prop="${prop}"]`).classList.add('active');
            renderPropertyImages();
        }

        async function loadPropertyImages() {
            try {
                const res = await fetch(config.apiBaseUrl + '/api/properties');
                propertyImages = await res.json();
                renderPropertyTabs();
                // Ensure currentProperty is valid, default to 'general' or first property
                if (!propertyImages[currentProperty]) {
                    currentProperty = Object.keys(propertyImages)[0] || 'general';
                }
                renderPropertyImages();
            } catch (e) {
                showToast('Failed to load property images', 'error');
            }
        }

        function renderPropertyTabs() {
            const tabsContainer = document.getElementById('propTabs');
            const properties = Object.keys(propertyImages);

            if (properties.length === 0) {
                tabsContainer.innerHTML = '<div style="color: var(--text-muted); font-size: 0.85rem; padding: 0.5rem;">No properties found.</div>';
            } else {
                tabsContainer.innerHTML = properties.map(prop => {
                    // Format name nicely (e.g., 'homes-manali' -> 'Homes Manali')
                    const displayName = prop === 'general' ? 'General' : prop.split('-').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
                    const activeClass = prop === currentProperty ? 'active' : '';
                    return `<button class="prop-tab ${activeClass}" data-prop="${prop}" onclick="switchProperty('${prop}')">${displayName}</button>`;
                }).join('');
            }
            // Add "+ New Property" button
            tabsContainer.innerHTML += `<button class="prop-tab" style="border-style: dashed;" onclick="createNewProperty()">+ New</button>`;
        }

        async function createNewProperty() {
            const name = prompt('Enter new property name (e.g., "homes-goa"):');
            if (!name) return;

            try {
                const res = await fetch(config.apiBaseUrl + '/api/properties/categories', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name })
                });

                if (!res.ok) throw new Error(await res.text());

                const data = await res.json();
                showToast('Property created successfully!');
                currentProperty = data.property; // Switch to the new property
                loadPropertyImages(); // Reload
            } catch (e) {
                showToast('Failed to create property: ' + (e.message || 'Unknown error'), 'error');
            }
        }

        function renderPropertyImages() {
            const grid = document.getElementById('propImageGrid');
            const images = propertyImages[currentProperty] || [];
            if (images.length === 0) {
                grid.innerHTML = '<div class="loading">No images for this property yet.</div>';
                return;
            }
            grid.innerHTML = images.map(img => {
                const safeFilename = img.filename.replace(/'/g, "\\'").replace(/"/g, '&quot;');
                const displayFilename = img.filename.length > 16 ? img.filename.slice(0, 16) + '...' : img.filename;
                // Prepend base URL for images rendered in the admin dashboard so they load correctly from backend
                const imageUrl = config.apiBaseUrl ? `${config.apiBaseUrl}/${encodeURI(img.path)}` : `/${encodeURI(img.path)}`;
                return `
                <div class="image-card">
                    <img src="${imageUrl}" alt="${img.filename.replace(/"/g, '&quot;')}" onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22100%22 height=%22100%22><text x=%2250%%22 y=%2250%%22 text-anchor=%22middle%22 fill=%22gray%22>Error</text></svg>'">
                    <div class="image-card-info">
                        <span title="${escHtml(img.filename)}">${escHtml(displayFilename)}</span>
                        <button class="image-card-delete" onclick="deletePropertyImage('${currentProperty}','${safeFilename}')" title="Delete">‚úï</button>
                    </div>
                </div>
            `}).join('');
            
            // Toggle Delete Property button visibility
            const deleteBtn = document.getElementById('deletePropertyBtn');
            if (currentProperty === 'general') {
                deleteBtn.style.display = 'none';
            } else {
                deleteBtn.style.display = 'inline-flex';
            }
        }

        // File upload click handler
        document.getElementById('propFileUpload').addEventListener('click', () => {
            document.getElementById('propFileInput').click();
        });

        async function uploadPropertyImage() {
            const fileInput = document.getElementById('propFileInput');
            const file = fileInput.files[0];
            if (!file) return;

            document.getElementById('propFileName').textContent = file.name;
            const formData = new FormData();
            formData.append('image', file);

            try {
                const res = await fetch(config.apiBaseUrl + `/api/properties/${currentProperty}/images`, {
                    method: 'POST',
                    body: formData
                });
                if (!res.ok) throw new Error(await res.text());
                showToast('Image uploaded!');
                document.getElementById('propFileName').textContent = '';
                fileInput.value = '';
                loadPropertyImages();
            } catch (e) {
                showToast('Upload failed: ' + e.message, 'error');
            }
        }

        async function deletePropertyImage(prop, filename) {
            if (!confirm(`Delete ${filename}?`)) return;
            try {
                // BUGFIX: Frontend shouldn't encode a filename twice, or encode what is already safe
                const res = await fetch(config.apiBaseUrl + `/api/properties/${prop}/images/${filename}`, { method: 'DELETE' });
                if (!res.ok) throw new Error('Delete failed');
                showToast('Image deleted');
                loadPropertyImages();
            } catch (e) {
                showToast('Error deleting image', 'error');
            }
        }
        
        async function deleteCurrentProperty() {
            if (currentProperty === 'general') return;
            if (!confirm(`Are you sure you want to delete the property "${currentProperty}" AND all of its images? This cannot be undone.`)) return;
            
            try {
                const res = await fetch(config.apiBaseUrl + `/api/properties/categories/${currentProperty}`, { method: 'DELETE' });
                if (!res.ok) throw new Error(await res.text());
                
                showToast(`Property "${currentProperty}" deleted`);
                currentProperty = 'general'; // Default back to general
                loadPropertyImages();
            } catch (e) {
                showToast('Error deleting property: ' + (e.message || 'Unknown error'), 'error');
            }
        }

        // ‚îÄ‚îÄ‚îÄ Helpers ‚îÄ‚îÄ‚îÄ
        function escHtml(str) {
            if (!str) return '';
            const div = document.createElement('div');
            div.textContent = str;
            return div.innerHTML;
        }

        // ‚îÄ‚îÄ‚îÄ Init ‚îÄ‚îÄ‚îÄ
        document.addEventListener('DOMContentLoaded', () => {
            loadBlogs();
            loadExperiences();
            loadPropertyImages();
        });

        // File input display names
        document.getElementById('blogImageFile').addEventListener('change', function () {
            document.getElementById('blogImageName').textContent = this.files[0] ? this.files[0].name : '';
        });
        document.getElementById('expImageFile').addEventListener('change', function () {
            document.getElementById('expImageName').textContent = this.files[0] ? this.files[0].name : '';
        });
    </script>
</body>

</html>